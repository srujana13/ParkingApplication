
-- Create table
create table PARKING_LOT
(
  NAME VARCHAR2 (19) not null,
  ADDRESS  VARCHAR2(36) not null,
  SPACE_COUNT NUMBER(19) not null,
  VISITOR_SPACE_COUNT NUMBER(19) not null,
  BEGINNING_SPACE_NUMBER NUMBER(19) not null
) ;

-- Create table
create table ZONE
(
   ZONE_ID VARCHAR2 (2) not null
) ;

-- Create relation table for ZONE_DESIGNATION and Zone
create table ZONE_DESIGNATION
(
   ZONE_ID VARCHAR2 (2) not null,
   NAME    VARCHAR2 (19) not null
) ;

-- Add primary keys to all the tables Zone, Parking Lots and Zone Designation
alter table PARKING_LOT
  add constraint PARKING_LOT_PK primary key (NAME);

alter table ZONE
  add constraint ZONE_PK unique (ZONE_ID);

alter table ZONE_DESIGNATION
  add constraint ZONE_DESIGNATION_PK unique (ZONE_ID,NAME);

-- Add foreign key constraint to Zone Designation
alter table ZONE_DESIGNATION
  add constraint ZONE_DESIGNATION_FK1 foreign key (ZONE_ID)
      references ZONE (ZONE_ID);

-- Add foreign key constraint to Zone Designation
alter table ZONE_DESIGNATION
  add constraint ZONE_DESIGNATION_FK2 foreign key (NAME)
      references PARKING_LOT (NAME);

-- Create a table for parking lot and spaces
create table PARKING_SPACE
(
  SPACE_NO NUMBER(19) not null,
  SPACE_TYPE VARCHAR2 (32) not null,
  PARKING_LOT_NAME VARCHAR2 (19) not null
) ;


-- Add PRIMARY key constraint for the Parking space table
alter table PARKING_SPACE
 add constraint PARKING_SPACE_PK primary key (SPACE_NO);


-- Add foreign key constraint for the Parking space table
alter table PARKING_SPACE
  add constraint PARKING_SPACE_FK foreign key (PARKING_LOT_NAME)
      references PARKING_LOT (NAME);



Commit;

--Insert values in Parking_Lot Table

INSERT INTO PARKING_LOT (NAME,ADDRESS,SPACE_COUNT,VISITOR_SPACE_COUNT,BEGINNING_SPACE_NUMBER)
VALUES
   ('Freedom Lot','2105 Daniel Allen St, NC 27505',150,0,1);

INSERT INTO PARKING_LOT (NAME,ADDRESS,SPACE_COUNT,VISITOR_SPACE_COUNT,BEGINNING_SPACE_NUMBER)
VALUES
   ('Premiere Lot','2108 McKent St, NC 27507',200,1,1);

INSERT INTO PARKING_LOT (NAME,ADDRESS,SPACE_COUNT,VISITOR_SPACE_COUNT,BEGINNING_SPACE_NUMBER)
VALUES
   ('Justice Lot','2704 Ben Clark St, NC 26701',175,25,1);


--Insert values in Zone table

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('A');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('B');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('C');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('D');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('AS');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('BS');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('CS');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('DS');

INSERT INTO ZONE (ZONE_ID)
VALUES
   ('V');


-- Insert Data into Zone_Designation
INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('A','Freedom Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('B','Freedom Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('C','Freedom Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('D','Freedom Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('A','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('B','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('C','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('D','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('AS','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('BS','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('CS','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('DS','Premiere Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('V','Premiere Lot');


INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('AS','Justice Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('BS','Justice Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('CS','Justice Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('DS','Justice Lot');

INSERT INTO ZONE_DESIGNATION (ZONE_ID, NAME)
VALUES
   ('V','Justice Lot');


commit;

-- Insert data in Parking Space table
INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (151,'Handicapped','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (152,'Handicapped','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (153,'Handicapped','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (154,'Handicapped','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (155,'Handicapped','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (172,'Electric','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (173,'Electric','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (174,'Electric','Justice Lot');

INSERT INTO PARKING_SPACE (SPACE_NO, SPACE_TYPE, PARKING_LOT_NAME)
VALUES
   (175,'Electric','Justice Lot');

COMMIT;

-- Create Vehicle Table

CREATE TABLE VEHICLE(
  MANUFACTURER VARCHAR2(19),
  MODEL VARCHAR2(19),
  YEAR VARCHAR2(19),
  COLOR VARCHAR2(19),
  LICENSE_PLATE_NO VARCHAR2(20) NOT NULL PRIMARY KEY
);


-- CREATING the Permits table

CREATE TABLE VISITOR_PERMIT(
  PERMIT_ID VARCHAR2(19) NOT NULL ,
  PRIMARY_VEHICLE_NO VARCHAR2(8) NOT NULL ,
  START_DATE DATE NOT NULL ,
  START_TIME TIMESTAMP NOT NULL,
  EXP_DATE DATE NOT NULL,
  EXP_TIME TIMESTAMP NOT NULL,
  DURATION NUMBER(2) NOT NULL ,
  ZONE_ID VARCHAR2(2) NOT NULL,
  SPACE_TYPE VARCHAR2(19) NOT NULL,
  SPACE_NO NUMBER(19) NOT NULL ,
  LOT VARCHAR2(19) NOT NULL ,
  CONSTRAINT CHK_PERMIT_ID CHECK (PERMIT_ID like '[0-9]{2}[a-zA-Z]{1,2}[a-zA-Z0-9]{4,5}')
);

alter table VISITOR_PERMIT
 add constraint VISITOR_PERMIT_PK unique (PERMIT_ID);

alter table VISITOR_PERMIT
 add constraint VISITOR_PERMIT_FK1 foreign key (LOT)
     references PARKING_LOT (NAME);

alter table VISITOR_PERMIT
 add constraint VISITOR_PERMIT_FK2 foreign key (ZONE_ID)
     references ZONE (ZONE_ID);

alter table VISITOR_PERMIT
 add constraint VISITOR_PERMIT_FK3 foreign key (PRIMARY_VEHICLE_NO)
     references VEHICLE (LICENSE_PLATE_NO);



CREATE TABLE NON_VISITOR_PERMIT(
  PERMIT_ID VARCHAR2(19) NOT NULL PRIMARY KEY,
  PRIMARY_VEHICLE_NO VARCHAR2(8) NOT NULL ,
  START_DATE DATE NOT NULL ,
  START_TIME TIMESTAMP NOT NULL,
  EXP_DATE DATE NOT NULL,
  EXP_TIME TIMESTAMP NOT NULL,
  ZONE_ID VARCHAR2(2) NOT NULL,
  SPACE_TYPE VARCHAR2(19) NOT NULL,
  UNIVID VARCHAR2(19) NOT NULL ,
  SECOND_VEHICLE VARCHAR2(20),
  FOREIGN KEY (SECOND_VEHICLE) REFERENCES VEHICLE (LICENSE_PLATE_NO),
  FOREIGN KEY (PRIMARY_VEHICLE_NO) REFERENCES VEHICLE (LICENSE_PLATE_NO),
  FOREIGN KEY (ZONE_ID) REFERENCES ZONE (ZONE_ID),
  CONSTRAINT CHK_PERMIT_ID1 CHECK (PERMIT_ID like '[0-9]{2}[a-zA-Z]{1,2}[a-zA-Z0-9]{4,5}')
);

